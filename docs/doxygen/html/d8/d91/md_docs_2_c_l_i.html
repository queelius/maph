<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>maph: Maph CLI Documentation</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">maph<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-Performance Memory-Mapped Key-Value Database with O(1) Lookups</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d8/d91/md_docs_2_c_l_i.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Maph CLI Documentation</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md189"></a> </p>
<h1><a class="anchor" id="autotoc_md190"></a>
Overview</h1>
<p>The <code>maph</code> command-line interface provides a convenient way to interact with Maph databases from the terminal. It supports all core operations including database creation, key-value manipulation, batch operations, and performance benchmarking.</p>
<h1><a class="anchor" id="autotoc_md191"></a>
Installation</h1>
<div class="fragment"><div class="line"># Build from source</div>
<div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake ..</div>
<div class="line">make maph_cli</div>
<div class="line"> </div>
<div class="line"># Install system-wide (optional)</div>
<div class="line">sudo cp maph_cli /usr/local/bin/maph</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md192"></a>
Command Reference</h1>
<h2><a class="anchor" id="autotoc_md193"></a>
Global Synopsis</h2>
<div class="fragment"><div class="line">maph &lt;command&gt; [arguments] [options]</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md194"></a>
Commands</h2>
<h3><a class="anchor" id="autotoc_md195"></a>
create - Create a new database</h3>
<p>Creates a new Maph database file with the specified number of slots.</p>
<div class="fragment"><div class="line">maph create &lt;file&gt; &lt;slots&gt;</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file to create</li>
<li><code>slots</code> - Number of slots to allocate (determines maximum capacity)</li>
</ul>
<p><b>Examples:</b> </p><div class="fragment"><div class="line"># Create database with 1 million slots</div>
<div class="line">maph create data.maph 1000000</div>
<div class="line"> </div>
<div class="line"># Create database with 10,000 slots</div>
<div class="line">maph create small.maph 10000</div>
<div class="line"> </div>
<div class="line"># Create database in specific directory</div>
<div class="line">maph create /var/lib/myapp/cache.maph 500000</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md196"></a>
set - Store a key-value pair</h3>
<p>Sets or updates a value for the specified key.</p>
<div class="fragment"><div class="line">maph set &lt;file&gt; &lt;key&gt; &lt;value&gt;</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file</li>
<li><code>key</code> - Key to store (any string)</li>
<li><code>value</code> - Value to store (max 496 bytes)</li>
</ul>
<p><b>Examples:</b> </p><div class="fragment"><div class="line"># Store simple value</div>
<div class="line">maph set data.maph &quot;user:1&quot; &quot;Alice&quot;</div>
<div class="line"> </div>
<div class="line"># Store JSON value</div>
<div class="line">maph set data.maph &quot;config&quot; &#39;{&quot;timeout&quot;: 30, &quot;retries&quot;: 3}&#39;</div>
<div class="line"> </div>
<div class="line"># Store with special characters</div>
<div class="line">maph set data.maph &quot;path:/usr/bin&quot; &quot;/usr/bin/env&quot;</div>
</div><!-- fragment --><p><b>Exit Codes:</b></p><ul>
<li>0 - Success</li>
<li>1 - Failed (value too large or database full)</li>
</ul>
<h3><a class="anchor" id="autotoc_md197"></a>
get - Retrieve a value</h3>
<p>Gets the value associated with a key.</p>
<div class="fragment"><div class="line">maph get &lt;file&gt; &lt;key&gt;</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file</li>
<li><code>key</code> - Key to retrieve</li>
</ul>
<p><b>Output:</b></p><ul>
<li>Prints the value to stdout if found</li>
<li>Prints "null" if key not found</li>
</ul>
<p><b>Examples:</b> </p><div class="fragment"><div class="line"># Get a value</div>
<div class="line">maph get data.maph &quot;user:1&quot;</div>
<div class="line"># Output: Alice</div>
<div class="line"> </div>
<div class="line"># Get non-existent key</div>
<div class="line">maph get data.maph &quot;nonexistent&quot;</div>
<div class="line"># Output: null</div>
<div class="line"> </div>
<div class="line"># Use in scripts</div>
<div class="line">value=$(maph get data.maph &quot;config&quot;)</div>
<div class="line">if [ &quot;$value&quot; != &quot;null&quot; ]; then</div>
<div class="line">    echo &quot;Config: $value&quot;</div>
<div class="line">fi</div>
</div><!-- fragment --><p><b>Exit Codes:</b></p><ul>
<li>0 - Key found</li>
<li>1 - Key not found</li>
</ul>
<h3><a class="anchor" id="autotoc_md198"></a>
remove - Delete a key</h3>
<p>Removes a key-value pair from the database.</p>
<div class="fragment"><div class="line">maph remove &lt;file&gt; &lt;key&gt;</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file</li>
<li><code>key</code> - Key to remove</li>
</ul>
<p><b>Examples:</b> </p><div class="fragment"><div class="line"># Remove a key</div>
<div class="line">maph remove data.maph &quot;user:1&quot;</div>
<div class="line"># Output: OK</div>
<div class="line"> </div>
<div class="line"># Remove non-existent key</div>
<div class="line">maph remove data.maph &quot;nonexistent&quot;</div>
<div class="line"># Output: Not found</div>
</div><!-- fragment --><p><b>Exit Codes:</b></p><ul>
<li>0 - Key removed successfully</li>
<li>1 - Key not found</li>
</ul>
<h3><a class="anchor" id="autotoc_md199"></a>
stats - Show database statistics</h3>
<p>Displays detailed statistics about the database.</p>
<div class="fragment"><div class="line">maph stats &lt;file&gt;</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file</li>
</ul>
<p><b>Output Format:</b> </p><div class="fragment"><div class="line">Database: data.maph</div>
<div class="line">Total slots: 1000000</div>
<div class="line">Static slots: 800000</div>
<div class="line">Used slots: 42531</div>
<div class="line">Load factor: 0.0425</div>
<div class="line">Memory usage: 512512000 bytes (488.77 MB)</div>
<div class="line">Generation: 85062</div>
</div><!-- fragment --><p><b>Examples:</b> </p><div class="fragment"><div class="line"># Show stats</div>
<div class="line">maph stats data.maph</div>
<div class="line"> </div>
<div class="line"># Parse specific stat in script</div>
<div class="line">used=$(maph stats data.maph | grep &quot;Used slots&quot; | awk &#39;{print $3}&#39;)</div>
<div class="line">echo &quot;Database has $used used slots&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md200"></a>
bench - Run single-threaded benchmark</h3>
<p>Performs a performance benchmark with sequential operations.</p>
<div class="fragment"><div class="line">maph bench &lt;file&gt;</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file</li>
</ul>
<p><b>Benchmark Operations:</b></p><ol type="1">
<li>Sequential writes (100,000 operations)</li>
<li>Sequential reads (1,000,000 operations)</li>
<li>Random reads (1,000,000 operations)</li>
<li>Mixed operations (80% read, 20% write)</li>
</ol>
<p><b>Output Example:</b> </p><div class="fragment"><div class="line">Running benchmark on data.maph...</div>
<div class="line"> </div>
<div class="line">Sequential Write Performance:</div>
<div class="line">  Operations: 100000</div>
<div class="line">  Time: 45.23 ms</div>
<div class="line">  Throughput: 2,210,000 ops/sec</div>
<div class="line">  Latency: 452 ns/op</div>
<div class="line"> </div>
<div class="line">Sequential Read Performance:</div>
<div class="line">  Operations: 1000000</div>
<div class="line">  Time: 198.45 ms</div>
<div class="line">  Throughput: 5,039,000 ops/sec</div>
<div class="line">  Latency: 198 ns/op</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md201"></a>
bench_parallel - Run multi-threaded benchmark</h3>
<p>Performs parallel performance benchmarking.</p>
<div class="fragment"><div class="line">maph bench_parallel &lt;file&gt; [threads]</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file</li>
<li><code>threads</code> - Number of threads (optional, default: CPU cores)</li>
</ul>
<p><b>Examples:</b> </p><div class="fragment"><div class="line"># Use all CPU cores</div>
<div class="line">maph bench_parallel data.maph</div>
<div class="line"> </div>
<div class="line"># Use 8 threads</div>
<div class="line">maph bench_parallel data.maph 8</div>
<div class="line"> </div>
<div class="line"># Use 4 threads</div>
<div class="line">maph bench_parallel data.maph 4</div>
</div><!-- fragment --><p><b>Output Example:</b> </p><div class="fragment"><div class="line">Running parallel benchmark with 8 threads...</div>
<div class="line"> </div>
<div class="line">Parallel Write Performance:</div>
<div class="line">  Operations: 800000</div>
<div class="line">  Time: 156.78 ms</div>
<div class="line">  Throughput: 5,102,000 ops/sec</div>
<div class="line">  Latency: 196 ns/op</div>
<div class="line"> </div>
<div class="line">Parallel Read Performance:</div>
<div class="line">  Operations: 8000000</div>
<div class="line">  Time: 412.34 ms</div>
<div class="line">  Throughput: 19,410,000 ops/sec</div>
<div class="line">  Latency: 51 ns/op</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md202"></a>
load_bulk - Import JSONL file</h3>
<p>Loads data from a JSONL (JSON Lines) file in parallel.</p>
<div class="fragment"><div class="line">maph load_bulk &lt;file&gt; &lt;jsonl&gt; [--threads &lt;n&gt;]</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file</li>
<li><code>jsonl</code> - Path to JSONL input file</li>
</ul>
<p><b>Options:</b></p><ul>
<li><code>--threads &lt;n&gt;</code> - Number of threads for parallel loading</li>
</ul>
<p><b>JSONL Format:</b> Each line should be a JSON object with "key" and "value" fields: </p><div class="fragment"><div class="line">{&quot;key&quot;: &quot;user:1&quot;, &quot;value&quot;: &quot;{\&quot;name\&quot;: \&quot;Alice\&quot;, \&quot;age\&quot;: 30}&quot;}</div>
<div class="line">{&quot;key&quot;: &quot;user:2&quot;, &quot;value&quot;: &quot;{\&quot;name\&quot;: \&quot;Bob\&quot;, \&quot;age\&quot;: 25}&quot;}</div>
<div class="line">{&quot;key&quot;: &quot;product:100&quot;, &quot;value&quot;: &quot;{\&quot;name\&quot;: \&quot;Widget\&quot;, \&quot;price\&quot;: 29.99}&quot;}</div>
</div><!-- fragment --><p><b>Examples:</b> </p><div class="fragment"><div class="line"># Load with default parallelism</div>
<div class="line">maph load_bulk data.maph import.jsonl</div>
<div class="line"> </div>
<div class="line"># Load with 4 threads</div>
<div class="line">maph load_bulk data.maph import.jsonl --threads 4</div>
<div class="line"> </div>
<div class="line"># Generate and load test data</div>
<div class="line">cat &gt; test.jsonl &lt;&lt; EOF</div>
<div class="line">{&quot;key&quot;: &quot;test:1&quot;, &quot;value&quot;: &quot;value1&quot;}</div>
<div class="line">{&quot;key&quot;: &quot;test:2&quot;, &quot;value&quot;: &quot;value2&quot;}</div>
<div class="line">EOF</div>
<div class="line">maph load_bulk data.maph test.jsonl</div>
</div><!-- fragment --><p><b>Output:</b> </p><div class="fragment"><div class="line">Loading import.jsonl into data.maph...</div>
<div class="line">Using 4 threads</div>
<div class="line">Processed 10000 lines</div>
<div class="line">Successfully stored: 9998</div>
<div class="line">Failed: 2 (duplicate or full)</div>
<div class="line">Time: 23.45 ms</div>
<div class="line">Throughput: 426,439 records/sec</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md203"></a>
mget - Get multiple keys</h3>
<p>Retrieves multiple keys in a single operation.</p>
<div class="fragment"><div class="line">maph mget &lt;file&gt; &lt;key1&gt; [key2] [key3] ...</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file</li>
<li><code>key1, key2, ...</code> - Keys to retrieve</li>
</ul>
<p><b>Output Format:</b> </p><div class="fragment"><div class="line">key1: value1</div>
<div class="line">key2: value2</div>
<div class="line">key3: null</div>
</div><!-- fragment --><p><b>Examples:</b> </p><div class="fragment"><div class="line"># Get multiple keys</div>
<div class="line">maph mget data.maph &quot;user:1&quot; &quot;user:2&quot; &quot;user:3&quot;</div>
<div class="line"> </div>
<div class="line"># Use with xargs</div>
<div class="line">echo -e &quot;key1\nkey2\nkey3&quot; | xargs maph mget data.maph</div>
<div class="line"> </div>
<div class="line"># Parse output</div>
<div class="line">maph mget data.maph &quot;config&quot; &quot;status&quot; | grep &quot;config:&quot; | cut -d: -f2-</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md204"></a>
mset - Set multiple key-value pairs</h3>
<p>Sets multiple key-value pairs in a single operation.</p>
<div class="fragment"><div class="line">maph mset &lt;file&gt; &lt;key1&gt; &lt;value1&gt; [key2] [value2] ...</div>
</div><!-- fragment --><p><b>Arguments:</b></p><ul>
<li><code>file</code> - Path to the database file</li>
<li>Pairs of keys and values</li>
</ul>
<p><b>Examples:</b> </p><div class="fragment"><div class="line"># Set multiple pairs</div>
<div class="line">maph mset data.maph \</div>
<div class="line">    &quot;user:1&quot; &quot;Alice&quot; \</div>
<div class="line">    &quot;user:2&quot; &quot;Bob&quot; \</div>
<div class="line">    &quot;user:3&quot; &quot;Charlie&quot;</div>
<div class="line"> </div>
<div class="line"># Set configuration values</div>
<div class="line">maph mset data.maph \</div>
<div class="line">    &quot;config:timeout&quot; &quot;30&quot; \</div>
<div class="line">    &quot;config:retries&quot; &quot;3&quot; \</div>
<div class="line">    &quot;config:debug&quot; &quot;false&quot;</div>
</div><!-- fragment --><p><b>Output:</b> </p><div class="fragment"><div class="line">Stored 3 pairs successfully</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md205"></a>
Options</h2>
<h3><a class="anchor" id="autotoc_md206"></a>
Global Options</h3>
<p>These options can be used with any command:</p>
<h4><a class="anchor" id="autotoc_md207"></a>
–threads &lt;n&gt;</h4>
<p>Specify the number of threads for parallel operations.</p>
<div class="fragment"><div class="line">maph load_bulk data.maph input.jsonl --threads 8</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md208"></a>
–durability &lt;ms&gt;</h4>
<p>Enable automatic durability with specified interval in milliseconds.</p>
<div class="fragment"><div class="line">maph set data.maph key value --durability 1000  # Sync every second</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md209"></a>
–verbose</h4>
<p>Enable verbose output for debugging.</p>
<div class="fragment"><div class="line">maph --verbose set data.maph key value</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md210"></a>
–help</h4>
<p>Display help information.</p>
<div class="fragment"><div class="line">maph --help</div>
<div class="line">maph create --help</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md211"></a>
Usage Patterns</h1>
<h2><a class="anchor" id="autotoc_md212"></a>
Database Management</h2>
<div class="fragment"><div class="line"># Create database</div>
<div class="line">maph create myapp.maph 1000000</div>
<div class="line"> </div>
<div class="line"># Check database size</div>
<div class="line">ls -lh myapp.maph</div>
<div class="line"> </div>
<div class="line"># Check database stats</div>
<div class="line">maph stats myapp.maph</div>
<div class="line"> </div>
<div class="line"># Backup database (it&#39;s just a file!)</div>
<div class="line">cp myapp.maph myapp.maph.backup</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md213"></a>
Data Import/Export</h2>
<div class="fragment"><div class="line"># Export to JSONL</div>
<div class="line">maph dump data.maph &gt; export.jsonl</div>
<div class="line"> </div>
<div class="line"># Import from JSONL</div>
<div class="line">maph load_bulk data.maph import.jsonl</div>
<div class="line"> </div>
<div class="line"># Convert from Redis dump</div>
<div class="line">redis-dump | transform_to_jsonl | maph load_bulk data.maph -</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md214"></a>
Performance Testing</h2>
<div class="fragment"><div class="line"># Quick benchmark</div>
<div class="line">maph bench data.maph</div>
<div class="line"> </div>
<div class="line"># Detailed parallel benchmark</div>
<div class="line">maph bench_parallel data.maph 8</div>
<div class="line"> </div>
<div class="line"># Custom workload test</div>
<div class="line">for i in {1..1000}; do</div>
<div class="line">    maph set data.maph &quot;test:$i&quot; &quot;value$i&quot;</div>
<div class="line">done</div>
<div class="line">time for i in {1..10000}; do</div>
<div class="line">    maph get data.maph &quot;test:$((RANDOM % 1000))&quot;</div>
<div class="line">done</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md215"></a>
Scripting Examples</h2>
<h3><a class="anchor" id="autotoc_md216"></a>
Health Check Script</h3>
<div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line">DB=&quot;data.maph&quot;</div>
<div class="line"> </div>
<div class="line"># Check if database exists</div>
<div class="line">if [ ! -f &quot;$DB&quot; ]; then</div>
<div class="line">    echo &quot;ERROR: Database not found&quot;</div>
<div class="line">    exit 1</div>
<div class="line">fi</div>
<div class="line"> </div>
<div class="line"># Get stats</div>
<div class="line">stats=$(maph stats &quot;$DB&quot;)</div>
<div class="line">used=$(echo &quot;$stats&quot; | grep &quot;Used slots&quot; | awk &#39;{print $3}&#39;)</div>
<div class="line">total=$(echo &quot;$stats&quot; | grep &quot;Total slots&quot; | awk &#39;{print $3}&#39;)</div>
<div class="line">load=$(echo &quot;$stats&quot; | grep &quot;Load factor&quot; | awk &#39;{print $3}&#39;)</div>
<div class="line"> </div>
<div class="line"># Check load factor</div>
<div class="line">if (( $(echo &quot;$load &gt; 0.8&quot; | bc -l) )); then</div>
<div class="line">    echo &quot;WARNING: Database is ${load}% full&quot;</div>
<div class="line">fi</div>
<div class="line"> </div>
<div class="line">echo &quot;Database healthy: $used/$total slots used&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md217"></a>
Batch Update Script</h3>
<div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line">DB=&quot;data.maph&quot;</div>
<div class="line"> </div>
<div class="line"># Read updates from file</div>
<div class="line">while IFS=: read -r key value; do</div>
<div class="line">    maph set &quot;$DB&quot; &quot;$key&quot; &quot;$value&quot;</div>
<div class="line">done &lt; updates.txt</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md218"></a>
Cache Warmer</h3>
<div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line">DB=&quot;cache.maph&quot;</div>
<div class="line"> </div>
<div class="line"># Warm cache with frequently accessed keys</div>
<div class="line">cat frequent_keys.txt | while read key; do</div>
<div class="line">    # Try to get to load into OS page cache</div>
<div class="line">    maph get &quot;$DB&quot; &quot;$key&quot; &gt; /dev/null 2&gt;&amp;1</div>
<div class="line">done</div>
<div class="line"> </div>
<div class="line">echo &quot;Cache warmed with $(wc -l &lt; frequent_keys.txt) keys&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md219"></a>
Error Handling</h1>
<h2><a class="anchor" id="autotoc_md220"></a>
Common Errors</h2>
<h3><a class="anchor" id="autotoc_md221"></a>
File Not Found</h3>
<div class="fragment"><div class="line">Error: Failed to open data.maph</div>
</div><!-- fragment --><p> <b>Solution:</b> Check file path and permissions</p>
<h3><a class="anchor" id="autotoc_md222"></a>
Value Too Large</h3>
<div class="fragment"><div class="line">Error: Value exceeds maximum size (496 bytes)</div>
</div><!-- fragment --><p> <b>Solution:</b> Reduce value size or split across multiple keys</p>
<h3><a class="anchor" id="autotoc_md223"></a>
Database Full</h3>
<div class="fragment"><div class="line">Error: Failed to set (database full)</div>
</div><!-- fragment --><p> <b>Solution:</b> Create larger database or remove unused keys</p>
<h3><a class="anchor" id="autotoc_md224"></a>
Permission Denied</h3>
<div class="fragment"><div class="line">Error: Permission denied</div>
</div><!-- fragment --><p> <b>Solution:</b> Check file permissions: <code>chmod 664 data.maph</code></p>
<h2><a class="anchor" id="autotoc_md225"></a>
Exit Codes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Code   </th><th class="markdownTableHeadNone">Meaning    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Success    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">Operation failed    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">Invalid arguments    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">File error    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">Database full   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md226"></a>
Performance Tips</h1>
<ol type="1">
<li><b>Use batch operations</b> for multiple keys: <div class="fragment"><div class="line"># Slow</div>
<div class="line">for key in &quot;${keys[@]}&quot;; do</div>
<div class="line">    maph get data.maph &quot;$key&quot;</div>
<div class="line">done</div>
<div class="line"> </div>
<div class="line"># Fast</div>
<div class="line">maph mget data.maph &quot;${keys[@]}&quot;</div>
</div><!-- fragment --></li>
<li><b>Enable durability</b> only when needed: <div class="fragment"><div class="line"># Critical data</div>
<div class="line">maph set data.maph important value --durability 1000</div>
<div class="line"> </div>
<div class="line"># Cache data (no durability needed)</div>
<div class="line">maph set cache.maph temp value</div>
</div><!-- fragment --></li>
<li><b>Size database appropriately</b>: <div class="fragment"><div class="line"># Too small = collisions</div>
<div class="line">maph create data.maph 100  # Bad for 1000 keys</div>
<div class="line"> </div>
<div class="line"># Right size = fast</div>
<div class="line">maph create data.maph 2000  # Good for 1000 keys</div>
</div><!-- fragment --></li>
</ol>
<h1><a class="anchor" id="autotoc_md227"></a>
Integration Examples</h1>
<h2><a class="anchor" id="autotoc_md228"></a>
Systemd Service</h2>
<div class="fragment"><div class="line">[Unit]</div>
<div class="line">Description=Maph Cache Warmer</div>
<div class="line">After=network.target</div>
<div class="line"> </div>
<div class="line">[Service]</div>
<div class="line">Type=oneshot</div>
<div class="line">ExecStart=/usr/local/bin/maph load_bulk /var/lib/myapp/cache.maph /var/lib/myapp/initial_data.jsonl</div>
<div class="line">User=myapp</div>
<div class="line">Group=myapp</div>
<div class="line"> </div>
<div class="line">[Install]</div>
<div class="line">WantedBy=multi-user.target</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md229"></a>
Cron Job</h2>
<div class="fragment"><div class="line"># Backup database daily</div>
<div class="line">0 3 * * * cp /var/lib/myapp/data.maph /backup/data.maph.$(date +\%Y\%m\%d)</div>
<div class="line"> </div>
<div class="line"># Clean old entries weekly</div>
<div class="line">0 4 * * 0 /usr/local/bin/clean_old_entries.sh</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md230"></a>
Docker Integration</h2>
<div class="fragment"><div class="line">FROM ubuntu:22.04</div>
<div class="line">RUN apt-get update &amp;&amp; apt-get install -y build-essential cmake</div>
<div class="line">COPY . /app</div>
<div class="line">WORKDIR /app</div>
<div class="line">RUN mkdir build &amp;&amp; cd build &amp;&amp; cmake .. &amp;&amp; make maph_cli</div>
<div class="line">RUN cp build/maph_cli /usr/local/bin/<a class="code hl_namespace" href="../../d7/dd1/namespacemaph.html">maph</a></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Create database on container start</span></div>
<div class="line">CMD [<span class="stringliteral">&quot;maph&quot;</span>, <span class="stringliteral">&quot;create&quot;</span>, <span class="stringliteral">&quot;/data/cache.maph&quot;</span>, <span class="stringliteral">&quot;1000000&quot;</span>]</div>
<div class="ttc" id="anamespacemaph_html"><div class="ttname"><a href="../../d7/dd1/namespacemaph.html">maph</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d41/maph_8hpp_source.html#l00046">maph.hpp:46</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md231"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md232"></a>
Debug Mode</h2>
<p>Set environment variable for debug output: </p><div class="fragment"><div class="line">MAPH_DEBUG=1 maph get data.maph key</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md233"></a>
Verify Database Integrity</h2>
<div class="fragment"><div class="line"># Check magic number</div>
<div class="line">xxd -l 4 data.maph</div>
<div class="line"># Should show: 4d41 5048 (MAPH)</div>
<div class="line"> </div>
<div class="line"># Check stats consistency</div>
<div class="line">maph stats data.maph | grep -E &quot;(Used|Total) slots&quot;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md234"></a>
Performance Analysis</h2>
<div class="fragment"><div class="line"># Profile with time</div>
<div class="line">time maph bench data.maph</div>
<div class="line"> </div>
<div class="line"># Profile with perf</div>
<div class="line">perf stat maph bench_parallel data.maph</div>
<div class="line"> </div>
<div class="line"># Check I/O stats</div>
<div class="line">iostat -x 1 10 &amp; maph bench data.maph</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md235"></a>
See Also</h1>
<ul>
<li><a class="el" href="../../de/d23/md_docs_2_u_s_e_r___g_u_i_d_e.html">User Guide</a> - Comprehensive usage documentation</li>
<li><a class="el" href="../../d6/d41/md_docs_2_a_r_c_h_i_t_e_c_t_u_r_e.html">Architecture</a> - Internal design and implementation</li>
<li><a href="../../../include/maph.hpp">API Reference</a> - C++ API documentation</li>
<li><a class="el" href="../../d3/d1d/md_integrations_2rest__api_2_a_p_i.html">REST API</a> - HTTP interface documentation </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 4 2025 01:57:37 for maph by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
