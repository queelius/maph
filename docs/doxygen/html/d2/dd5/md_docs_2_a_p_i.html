<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>maph: RD-PH Filter API Documentation</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">maph<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-Performance Memory-Mapped Key-Value Database with O(1) Lookups</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d2/dd5/md_docs_2_a_p_i.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">RD-PH Filter API Documentation</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md106"></a> </p>
<h1><a class="anchor" id="autotoc_md107"></a>
C++ API</h1>
<h2><a class="anchor" id="autotoc_md108"></a>
Core Classes</h2>
<h3><a class="anchor" id="autotoc_md109"></a>
&lt;tt&gt;approximate_map&lt;PH, StorageType, Decoder, OutputType&gt;&lt;/tt&gt;</h3>
<p>Main template class for approximate mappings.</p>
<p><b>Template Parameters:</b></p><ul>
<li><code>PH</code>: Perfect hash function type</li>
<li><code>StorageType</code>: Storage type (uint8_t, uint16_t, uint32_t, uint64_t)</li>
<li><code>Decoder</code>: Decoder type defining the mapping behavior</li>
<li><code>OutputType</code>: Output type of the mapping</li>
</ul>
<p><b>Methods:</b> </p><div class="fragment"><div class="line"><span class="comment">// Construction</span></div>
<div class="line">approximate_map(<span class="keyword">const</span> PH&amp; ph, <span class="keyword">const</span> StorageType* M, uint64_t m);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Lookup operations</span></div>
<div class="line">OutputType operator()(<span class="keyword">const</span> T&amp; x) <span class="keyword">const</span>;</div>
<div class="line"><span class="keywordtype">bool</span> contains(<span class="keyword">const</span> T&amp; x) <span class="keyword">const</span>;  <span class="comment">// For set membership decoders</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Properties</span></div>
<div class="line">uint64_t size() <span class="keyword">const</span>;</div>
<div class="line"><span class="keywordtype">double</span> false_positive_rate() <span class="keyword">const</span>;</div>
<div class="line"><span class="keywordtype">double</span> false_negative_rate() <span class="keyword">const</span>;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md110"></a>
&lt;tt&gt;ApproxMapBuilder&lt;PH&gt;&lt;/tt&gt;</h3>
<p>Builder class for fluent construction.</p>
<p><b>Methods:</b> </p><div class="fragment"><div class="line"><span class="comment">// Configuration</span></div>
<div class="line">ApproxMapBuilder&amp; with_load_factor(<span class="keywordtype">double</span> factor);</div>
<div class="line">ApproxMapBuilder&amp; with_error_rate(<span class="keywordtype">double</span> rate);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Building filters</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> StorageType&gt;</div>
<div class="line"><span class="keyword">auto</span> build_set_filter(<span class="keyword">const</span> Range&amp; elements);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> StorageType&gt;</div>
<div class="line"><span class="keyword">auto</span> build_threshold_filter(<span class="keyword">const</span> Range&amp; elements, <span class="keywordtype">double</span> target_fpr);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> StorageType, <span class="keyword">typename</span> ValueRange&gt;</div>
<div class="line"><span class="keyword">auto</span> build_lookup(<span class="keyword">const</span> Range&amp; keys, <span class="keyword">const</span> ValueRange&amp; values);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md111"></a>
Decoders</h2>
<h3><a class="anchor" id="autotoc_md112"></a>
&lt;tt&gt;SetMembershipDecoder&lt;StorageType, H&gt;&lt;/tt&gt;</h3>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> operator()(StorageType value, H max_val) <span class="keyword">const</span>;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md113"></a>
&lt;tt&gt;ThresholdDecoder&lt;StorageType, H&gt;&lt;/tt&gt;</h3>
<div class="fragment"><div class="line">ThresholdDecoder(StorageType threshold);</div>
<div class="line"><span class="keywordtype">bool</span> operator()(StorageType value, H max_val) <span class="keyword">const</span>;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md114"></a>
&lt;tt&gt;IdentityDecoder&lt;StorageType, H&gt;&lt;/tt&gt;</h3>
<div class="fragment"><div class="line">StorageType operator()(StorageType value, H max_val) <span class="keyword">const</span>;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md115"></a>
Lazy Iterators</h2>
<h3><a class="anchor" id="autotoc_md116"></a>
&lt;tt&gt;lazy_generator_iterator&lt;Generator&gt;&lt;/tt&gt;</h3>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Generator&gt;</div>
<div class="line"><span class="keyword">class </span>lazy_generator_iterator {</div>
<div class="line">    lazy_generator_iterator(Generator gen, <span class="keywordtype">size_t</span> start, <span class="keywordtype">size_t</span> end);</div>
<div class="line">    value_type operator*() <span class="keyword">const</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md117"></a>
&lt;tt&gt;filter_iterator&lt;Iterator, Predicate&gt;&lt;/tt&gt;</h3>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iterator, <span class="keyword">typename</span> Predicate&gt;</div>
<div class="line"><span class="keyword">class </span>filter_iterator {</div>
<div class="line">    filter_iterator(Iterator begin, Iterator end, Predicate pred);</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md118"></a>
&lt;tt&gt;transform_iterator&lt;Iterator, Transform&gt;&lt;/tt&gt;</h3>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iterator, <span class="keyword">typename</span> Transform&gt;</div>
<div class="line"><span class="keyword">class </span>transform_iterator {</div>
<div class="line">    transform_iterator(Iterator it, Transform transform);</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md119"></a>
Convenience Functions</h2>
<div class="fragment"><div class="line"><span class="comment">// Create set membership filter</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> StorageType = u<span class="keywordtype">int</span>32_t&gt;</div>
<div class="line"><span class="keyword">auto</span> create_set_filter(<span class="keyword">const</span> Range&amp; elements, <span class="keywordtype">double</span> error_rate = 0.0);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create threshold filter</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> StorageType = u<span class="keywordtype">int</span>32_t&gt;</div>
<div class="line"><span class="keyword">auto</span> create_threshold_filter(<span class="keyword">const</span> Range&amp; elements, <span class="keywordtype">double</span> target_fpr);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create compact lookup</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> StorageType = u<span class="keywordtype">int</span>32_t&gt;</div>
<div class="line"><span class="keyword">auto</span> create_compact_lookup(<span class="keyword">const</span> Keys&amp; keys, <span class="keyword">const</span> Values&amp; values);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md120"></a>
Python API</h1>
<h2><a class="anchor" id="autotoc_md121"></a>
Module: &lt;tt&gt;approximate_filters&lt;/tt&gt;</h2>
<h3><a class="anchor" id="autotoc_md122"></a>
Filter Classes</h3>
<h4><a class="anchor" id="autotoc_md123"></a>
&lt;tt&gt;ApproxFilter8&lt;/tt&gt; / &lt;tt&gt;ApproxFilter16&lt;/tt&gt; / &lt;tt&gt;ApproxFilter32&lt;/tt&gt; / &lt;tt&gt;ApproxFilter64&lt;/tt&gt;</h4>
<p>Set membership filters with different storage sizes.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>ApproxFilter8:</div>
<div class="line">    <span class="keyword">def </span>__init__(self, elements, builder):</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;Create 8-bit filter from elements&quot;&quot;&quot;</span></div>
<div class="line">    </div>
<div class="line">    <span class="keyword">def </span>contains(self, x) -&gt; bool:</div>
<div class="line">        <span class="stringliteral">&quot;&quot;&quot;Check if x is in the filter&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    def __contains__(self, x) -&gt; bool:</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span>Python &#39;in&#39; operator support&quot;&quot;&quot;</div>
<div class="line">    </div>
<div class="line">    @property</div>
<div class="line">    def fpr(self) -&gt; float:</div>
<div class="line">        &quot;&quot;&quot;False positive rate&quot;&quot;&quot;</div>
<div class="line">    </div>
<div class="line">    def storage_bytes(self) -&gt; int:</div>
<div class="line">        &quot;&quot;&quot;Storage size in bytes&quot;&quot;&quot;</div>
<div class="line">    </div>
<div class="line">    def false_negative_rate(self) -&gt; float:</div>
<div class="line">        &quot;&quot;&quot;False negative rate&quot;&quot;&quot;</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md124"></a>
&lt;tt&gt;ThresholdFilter8&lt;/tt&gt; / &lt;tt&gt;ThresholdFilter16&lt;/tt&gt; / &lt;tt&gt;ThresholdFilter32&lt;/tt&gt; / &lt;tt&gt;ThresholdFilter64&lt;/tt&gt;</h4>
<p>Threshold filters with configurable FPR.</p>
<div class="fragment"><div class="line">class ThresholdFilter32:</div>
<div class="line">    def __init__(self, elements, builder, target_fpr: float):</div>
<div class="line">        &quot;&quot;&quot;Create threshold filter with target FP<span class="stringliteral">R&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    def contains(self, x) -&gt; bool:</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span>Check membership&quot;&quot;&quot;</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md125"></a>
&lt;tt&gt;CompactLookup8&lt;/tt&gt; / &lt;tt&gt;CompactLookup16&lt;/tt&gt; / &lt;tt&gt;CompactLookup32&lt;/tt&gt; / &lt;tt&gt;CompactLookup64&lt;/tt&gt;</h4>
<p>Compact lookup tables.</p>
<div class="fragment"><div class="line">class CompactLookup32:</div>
<div class="line">    def __init__(self, keys, values, builder):</div>
<div class="line">        &quot;&quot;&quot;Create compact lookup table&quot;&quot;&quot;</div>
<div class="line">    </div>
<div class="line">    def __getitem__(self, key):</div>
<div class="line">        &quot;&quot;&quot;Get value for key&quot;&quot;&quot;</div>
<div class="line">    </div>
<div class="line">    def get(self, key, default=None):</div>
<div class="line">        &quot;&quot;&quot;Get value with default&quot;&quot;&quot;</div>
<div class="line">    </div>
<div class="line">    def storage_bytes(self) -&gt; int:</div>
<div class="line">        &quot;&quot;&quot;Storage size in bytes&quot;&quot;&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md126"></a>
Builder Classes</h3>
<h4><a class="anchor" id="autotoc_md127"></a>
&lt;tt&gt;PerfectHashBuilder&lt;/tt&gt;</h4>
<div class="fragment"><div class="line">class PerfectHashBuilder:</div>
<div class="line">    def __init__(self, error_rate: float = 0.0):</div>
<div class="line">        &quot;&quot;&quot;Create perfect hash builder with error rate&quot;&quot;&quot;</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md128"></a>
&lt;tt&gt;ApproxMapBuilder&lt;/tt&gt;</h4>
<div class="fragment"><div class="line">class ApproxMapBuilder:</div>
<div class="line">    def __init__(self, ph_builder):</div>
<div class="line">        &quot;&quot;&quot;Create approximate map builde<span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    def with_load_factor(self, factor: float):</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span>Set load factor (returns self)&quot;&quot;&quot;</div>
<div class="line">    </div>
<div class="line">    def build_filter_8bit(self, elements):</div>
<div class="line">        &quot;&quot;&quot;Build 8-bit filte<span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    def build_filter_16bit(self, elements):</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span>Build 16-bit filte<span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    def build_filter_32bit(self, elements):</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span>Build 32-bit filte<span class="stringliteral">r&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral">    </span></div>
<div class="line"><span class="stringliteral">    def build_filter_64bit(self, elements):</span></div>
<div class="line"><span class="stringliteral">        &quot;&quot;&quot;</span>Build 64-bit filte<span class="stringliteral">r&quot;&quot;&quot;</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md129"></a>
Convenience Functions</h3>
<div class="fragment"><div class="line">def create_filter(elements, bits=32, error_rate=0.0):</div>
<div class="line">    &quot;&quot;&quot;Create a filter with specified bit width&quot;&quot;&quot;</div>
<div class="line"> </div>
<div class="line">def create_threshold_filter(elements, target_fpr, bits=32):</div>
<div class="line">    &quot;&quot;&quot;Create threshold filter with target FP<span class="stringliteral">R&quot;&quot;&quot;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">def create_lookup(keys, values, bits=32):</span></div>
<div class="line"><span class="stringliteral">    &quot;&quot;&quot;</span>Create compact lookup table&quot;&quot;&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md130"></a>
Constants</h3>
<div class="fragment"><div class="line">FPR_8BIT = 0.00390625   # 1/256</div>
<div class="line">FPR_16BIT = 1.52587890625e-05  # 1/65536</div>
<div class="line">FPR_32BIT = 2.3283064365386963e-10  # 1/2^32</div>
<div class="line">FPR_64BIT = 5.421010862427522e-20  # 1/2^64</div>
<div class="line"> </div>
<div class="line">__version__ = &quot;2.0.0&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md131"></a>
Usage Examples</h1>
<h2><a class="anchor" id="autotoc_md132"></a>
C++ Examples</h2>
<h3><a class="anchor" id="autotoc_md133"></a>
Basic Set Membership</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;rd_ph_filter/approximate_map.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line">std::vector&lt;std::string&gt; allowed = {<span class="stringliteral">&quot;alice&quot;</span>, <span class="stringliteral">&quot;bob&quot;</span>, <span class="stringliteral">&quot;charlie&quot;</span>};</div>
<div class="line"><span class="keyword">auto</span> filter = create_set_filter&lt;uint32_t&gt;(allowed);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (filter.contains(<span class="stringliteral">&quot;alice&quot;</span>)) {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;User allowed\n&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md134"></a>
Threshold Filter</h3>
<div class="fragment"><div class="line"><span class="keyword">auto</span> filter = create_threshold_filter&lt;uint16_t&gt;(elements, 0.05);</div>
<div class="line"><span class="comment">// 5% false positive rate with 16-bit storage</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md135"></a>
Compact Lookup</h3>
<div class="fragment"><div class="line">std::unordered_map&lt;std::string, int&gt; data = {</div>
<div class="line">    {<span class="stringliteral">&quot;red&quot;</span>, 0xFF0000},</div>
<div class="line">    {<span class="stringliteral">&quot;green&quot;</span>, 0x00FF00},</div>
<div class="line">    {<span class="stringliteral">&quot;blue&quot;</span>, 0x0000FF}</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> lookup = create_compact_lookup&lt;uint32_t&gt;(</div>
<div class="line">    keys_from_map(data),</div>
<div class="line">    values_from_map(data)</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> rgb = lookup(<span class="stringliteral">&quot;red&quot;</span>);  <span class="comment">// 0xFF0000</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md136"></a>
Lazy Iteration</h3>
<div class="fragment"><div class="line"><span class="keyword">auto</span> lazy_gen = lazy_generator_iterator(</div>
<div class="line">    [](<span class="keywordtype">size_t</span> i) { <span class="keywordflow">return</span> compute_element(i); },</div>
<div class="line">    0, 1000000</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> filter = create_set_filter&lt;uint8_t&gt;(</div>
<div class="line">    lazy_gen.begin(), lazy_gen.end()</div>
<div class="line">);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md137"></a>
Python Examples</h2>
<h3><a class="anchor" id="autotoc_md138"></a>
Basic Usage</h3>
<div class="fragment"><div class="line">import approximate_filters as af</div>
<div class="line"> </div>
<div class="line"># Create filter</div>
<div class="line">elements = [&quot;apple&quot;, &quot;banana&quot;, &quot;cherry&quot;]</div>
<div class="line">filter = af.create_filter(elements, bits=32)</div>
<div class="line"> </div>
<div class="line"># Test membership</div>
<div class="line">if &quot;apple&quot; in filter:</div>
<div class="line">    print(&quot;Found apple&quot;)</div>
<div class="line"> </div>
<div class="line"># Check properties</div>
<div class="line">print(f&quot;Storage: {filter.storage_bytes()} bytes&quot;)</div>
<div class="line">print(f&quot;FPR: {filter.fpr:.2%}&quot;)</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md139"></a>
Threshold Filter</h3>
<div class="fragment"><div class="line"># Create filter with 5% FPR</div>
<div class="line">allowed_ips = [&quot;192.168.1.1&quot;, &quot;10.0.0.1&quot;, &quot;172.16.0.1&quot;]</div>
<div class="line">filter = af.create_threshold_filter(allowed_ips, target_fpr=0.05, bits=16)</div>
<div class="line"> </div>
<div class="line">if ip_address in filter:</div>
<div class="line">    process_request()</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md140"></a>
Compact Lookup</h3>
<div class="fragment"><div class="line"># Create compact color palette</div>
<div class="line">colors = {</div>
<div class="line">    &quot;red&quot;: 0xFF0000,</div>
<div class="line">    &quot;green&quot;: 0x00FF00,</div>
<div class="line">    &quot;blue&quot;: 0x0000FF</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">lookup = af.create_lookup(</div>
<div class="line">    list(colors.keys()),</div>
<div class="line">    list(colors.values()),</div>
<div class="line">    bits=32</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">rgb = lookup[&quot;red&quot;]  # 0xFF0000</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md141"></a>
Builder Pattern</h3>
<div class="fragment"><div class="line"># Configure and build</div>
<div class="line">builder = af.PerfectHashBuilder(error_rate=0.01)</div>
<div class="line">map_builder = af.ApproxMapBuilder(builder)</div>
<div class="line">map_builder = map_builder.with_load_factor(1.5)</div>
<div class="line"> </div>
<div class="line">filter = map_builder.build_filter_32bit(elements)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md142"></a>
Error Handling</h1>
<h2><a class="anchor" id="autotoc_md143"></a>
C++ Exceptions</h2>
<ul>
<li><code>std::invalid_argument</code>: Invalid parameters</li>
<li><code>std::runtime_error</code>: Construction failures</li>
<li><code>std::out_of_range</code>: Lookup failures (for non-set membership)</li>
</ul>
<h2><a class="anchor" id="autotoc_md144"></a>
Python Exceptions</h2>
<ul>
<li><code>ValueError</code>: Invalid parameters or mismatched sizes</li>
<li><code>KeyError</code>: Key not found in lookup (when not using get())</li>
<li><code>RuntimeError</code>: Construction or lookup failures </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 4 2025 01:57:37 for maph by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
